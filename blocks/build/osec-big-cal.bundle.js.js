"use strict";(globalThis.webpackChunkcalendar_block=globalThis.webpackChunkcalendar_block||[]).push([[2242],{5640(e,t,n){n.r(t),n.d(t,{default:()=>D});var r=n(1609),a=n(1129),s=n(4353),o=n.n(s),i=n(6986),c=n.n(i),d=n(8569),l=n.n(d);var u=n(1455),h=n.n(u),g=n(3832),p=n(5327),f=n(5143),y=n(790);function m({position:e,childRect:t,popoverRect:n,children:r}){const a="rgba(255,255,255,.95)",s=a,o="rgb(144,144,144)",i={backgroundColor:a,padding:".5em",border:`1px solid ${o}`,borderRadius:"5px"};return(0,y.jsx)(f.ArrowContainer,{position:e,childRect:t,popoverRect:n,arrowSize:8,className:"popover-arrow-container",arrowClassName:"popover-arrow",style:{zIndex:1,overflow:"visible"},arrowColor:o,arrowStyle:function(e){switch(e){case"left":return{right:1};case"right":return{left:1};case"bottom":return{top:0};default:return{bottom:0}}}(e),children:(0,y.jsx)(f.ArrowContainer,{position:e,childRect:t,popoverRect:n,arrowSize:8,style:{paddingLeft:0,paddingTop:0,paddingBottom:0,paddingRight:0},arrowColor:s,arrowStyle:function(e,t=10){switch(e){case"left":return{right:1,borderLeft:`${t}px solid ${s}`,zIndex:1};case"right":return{left:1,borderRight:`${t}px solid ${s}`,zIndex:1};case"bottom":return{top:1,borderBottom:`${t}px solid ${s}`,zIndex:1};default:return{bottom:1,borderTop:`${t}px solid ${s}`,zIndex:1}}}(e,8),children:(0,y.jsxs)("div",{style:i,children:[r,(0,y.jsxs)("p",{style:{marginTop:"4em"},children:["I'm Event popup content (position: ",e,")."]})]})})})}function x({event:e}){const t=e.end?`End: ${e.end.toLocaleDateString()} — ${e.end.toLocaleTimeString()}`:"";return(0,y.jsxs)("div",{children:[e.image&&(0,y.jsx)("img",{src:e.image.url,alt:e.alt}),(0,y.jsx)("h3",{style:{margin:"0 0 .5em"},children:e.title}),(0,y.jsxs)("p",{children:["Start: ",e.start.toLocaleDateString()," — ",e.start.toLocaleTimeString(),(0,y.jsx)("br",{}),t]})]})}function w(e){const{event:t,children:n,boundaryElement:a,selected:s,setSelected:o}=e,[i,c]=(0,r.useState)(!1),[d,l]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(!d)return;const e=setTimeout(()=>{c(!0)},250);return()=>{clearTimeout(e)}},[d]);const u=r.forwardRef(({children:e},t)=>("function"==typeof t?t(e):t.current=e,null));return(0,y.jsx)("div",{style:{position:"static",zIndex:9999},ref:u,onMouseEnter:e=>{l(!0),e.preventDefault()},onMouseLeave:e=>{l(!1),c(!1),e.preventDefault()},children:(0,y.jsx)(f.Popover,{parentElement:a,boundaryInset:window.innerWidth>400?20:0,isOpen:s||i,positions:["right","left","top","bottom"],reposition:!0,onClickOutside:()=>o(null),content:e=>(0,y.jsx)(m,{...e,children:(0,y.jsx)(x,{event:t})}),children:n})})}const v=new class{constructor(e){this.dayjs=e,this.cache={}}getRange(e){if(!e.start||!e.end)throw new Error("invalid argument type");let t=this.dayjs(e.start).startOf("day"),n=this.dayjs(e.end).add(1,"day").startOf("day");n.isBefore(t)&&([n,t]=[t,n]);let r=this.dayjs(t);const a=[],s={};let o=[];for(;r.isBefore(n)||r.isSame(n);){const e=r.unix();Array.isArray(this.cache[String(e)])?(o=o.concat(this.cache[String(e)]),s[String(e)]=!0):null===this.cache[String(e)]?this.cache[String(e)]=[]:(a.push(e),this.cache[String(e)]=null,s[String(e)]=!1),r=r.add(1,"day")}return{temp:s,start:{date:t.local().format(),unix:t.unix()},end:{date:n.local().format(),unix:n.unix()},cached:o,missing:this.getMissingRanges(a)}}addRequest(e){e.map(e=>{const t=String(s(e.start).startOf("day").unix());Array.isArray(this.cache[t])||(this.cache[t]=[]),this.cache[t].push(e)})}add(e){for(let t of Object.keys(e))this.dayjs.unix(parseInt(t)).isValid()&&(this.cache[t]=e[t])}purge(){for(const e of Object.keys(this.cache))delete this.cache[e]}getCachedRange(){const e=this.getDaysAsc();return{start:e.at(0),end:e.at(-1)}}getOldestDay(){const{end:e}=this.getCachedRange();return e||null}getNewestDay(){const{start:e}=this.getCachedRange();return e||null}getDaysAsc(){const e=Object.keys(this.cache);return e.sort(function(e,t){return parseInt(t)-parseInt(e)}),e.length?e.map(String):[]}getMissingRanges(e){const t=new Int32Array(e).sort();if(!t.length)return[];const n=[],r=86400;let a=t.at(0),s=null;return t.forEach(e=>{!(s&&s+r===e)&&s&&(n.push({start:String(a),end:String(s+r)}),a=e),s=e}),n.push({start:String(a),end:String(t.at(-1)+r)}),n}}(o());let b=e=>{};const S=e=>((0,r.useEffect)(()=>{e.onView(e.view)},[e.view]),(0,y.jsx)(p.A,{...e})),j=e=>Array.isArray(e)?e.map(e=>({...e,start:o().unix(parseInt(e.start)).toDate(),end:o().unix(parseInt(e.end)).toDate()})):[];function D(e){const{fixedDate:t,defaultView:n}=(e=>(e.view&&"oneday"===e.view&&(e.view="day"),e.view&&(e.defaultView=e.view,delete e.view),e.fixedDate&&(e.fixedDate=o().unix(parseInt(e.fixedDate)).valueOf()),e))(e);var s;s=e.locale.name,o().extend(c()),o().extend(l()),"en"!==s&&o().locale(s);const[i,d]=(0,r.useState)([]),[u,p]=(0,r.useState)(e.defaultView),[f,m]=(0,r.useState)(null),x=(0,r.useCallback)(async e=>{const t={start:o()(1e3*e.start).local().toDate(),end:o()(1e3*e.end).local().endOf("day").toDate()},n=v.getRange(t);if(n.cached.length&&(d(n.cached),n.cached),n.missing.length)for(const e of n.missing){b((o()(1e3*parseInt(e.start)).local().toString(),o()(1e3*parseInt(e.end)).local().toString()));const t=(0,g.addQueryArgs)("/osec/v1/days",e),n=await h()({path:t});b(0);const r=j(n.events);d(e=>[...e,...r]),v.addRequest(r),b(0)}},[d]),{getNow:D,localizer:R,boundaryElement:I}=(0,r.useMemo)(()=>({getNow:()=>o()().toDate(),localizer:(0,a.vH)(o()),boundaryElement:document.getElementById(e.id).closest(".osec-react-big-calendar")})),k=(0,r.useMemo)(()=>({eventWrapper:e=>(e.boundaryElement=I,(0,y.jsx)(w,{...e,setSelected:m})),toolbar:S}),[I]);return(0,y.jsx)(a.Vv,{localizer:R,events:i,getNow:D,endAccessor:"end",style:{height:"90vh",fontSize:".9rem"},defaultView:n,onRangeChange:(e,t)=>(d([]),((e,t)=>{let n=e;switch(t){case"week":n={start:e[0],end:e[6]};break;case"agenda":n={start:e.start,end:o()(e.start).endOf("month").toDate()};break;case"day":n={start:e[0],end:o()(e[0]).endOf("day").toDate()}}return o()(n.start).toDate(),o()(n.end).toDate(),x({start:o()(n.start).unix(),end:o()(n.end).unix()})})(e,null!=t?t:u)),onView:e=>{p(e)},components:k,onSelectEvent:m,selected:f,tooltip:()=>null,titleAccessor:e=>"month"===u?`${e.title} ${o()(e.start).local().format("LT")}`:`${e.title}`})}}}]);